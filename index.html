<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß† Hafƒ±za E≈üle≈ütirme Oyunu</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
      color: white;
    }

    /* üåà Hareketli degrade arka plan */
    body {
      background: linear-gradient(270deg, #ff6f61, #6a5acd, #00b4d8, #ffd166);
      background-size: 800% 800%;
      animation: gradientFlow 25s ease infinite;
    }

    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ü´ß Baloncuk katmanƒ± */
    canvas#bubbles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    /* üè† Ana Men√º */
    #menu {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(6px);
      z-index: 5;
    }

    #menu h1 {
      font-size: 26px;
      margin-bottom: 20px;
    }

    .menu-btn {
      background: #f77f00;
      color: white;
      padding: 12px 20px;
      margin: 8px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 200px;
    }

    #header {
      text-align: center;
      padding: 10px;
      background: rgba(0,0,0,0.6);
      position: sticky;
      top: 0;
      z-index: 5;
      display: none;
    }

    #levelDisplay, #scoreDisplay {
      display: inline-block;
      background: #f77f00;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 16px;
      margin: 5px;
    }

    #board {
      display: none;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      padding: 10px;
      justify-items: center;
      overflow-y: auto;
      height: calc(100vh - 70px);
    }

    .card {
      width: 30vw;
      max-width: 120px;
      aspect-ratio: 1/1;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      perspective: 800px;
    }

    .inner {
      width: 100%;
      height: 100%;
      transition: transform 0.4s;
      transform-style: preserve-3d;
      position: relative;
    }

    .flipped .inner { transform: rotateY(180deg); }

    .front, .back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 10px;
    }

    .front {
      transform: rotateY(180deg);
    }

    .front img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .back {
      background-color: #d62828;
      background-image:
        repeating-linear-gradient(45deg, white 0px, white 3px, transparent 3px, transparent 10px),
        repeating-linear-gradient(-45deg, white 0px, white 3px, transparent 3px, transparent 10px);
      background-size: 20px 20px;
      border: 2px solid #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    }

    .matched {
      pointer-events: none;
      animation: zoomFlash 0.6s ease;
      filter: brightness(1.3);
      border: 3px solid limegreen;
    }

    @keyframes zoomFlash {
      0% { transform: scale(1); }
      40% { transform: scale(1.3); box-shadow: 0 0 15px limegreen; }
      100% { transform: scale(1); box-shadow: none; }
    }

    #backToMenu {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: #f77f00;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: none;
    }

  </style>
</head>
<body>

<canvas id="bubbles"></canvas>

<!-- üè† Ana Men√º -->
<div id="menu">
  <h1>üß† Hafƒ±za E≈üle≈ütirme Oyunu</h1>
  <button class="menu-btn" onclick="startGame()">üéÆ Oyuna Ba≈üla</button>
  <button class="menu-btn" onclick="showLeaderboard()">üèÜ Rekorlar</button>
</div>

<div id="header">
  <div id="levelDisplay">Seviye: 1</div>
  <div id="scoreDisplay">Puan: 0</div>
</div>

<div id="board"></div>

<button id="backToMenu" onclick="returnToMenu()">‚Ü© Ana Men√º</button>

<audio id="flipSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5d0c1c3b4b.mp3?filename=pop-94319.mp3"></audio>
<audio id="matchSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_d4d86a64f7.mp3?filename=soft-notification-102131.mp3"></audio>

<script>
const IMAGE_PATH = "./images/";
const TOTAL_IMAGES = 41;
const TOTAL_LEVELS = 10;
let level = 1, score = 0, flippedCards = [], matchedPairs = 0;

const flipSound = document.getElementById('flipSound');
const matchSound = document.getElementById('matchSound');

function startGame() {
  document.getElementById('menu').style.display = 'none';
  document.getElementById('header').style.display = 'block';
  document.getElementById('board').style.display = 'grid';
  document.getElementById('backToMenu').style.display = 'block';
  level = 1;
  score = 0;
  startLevel();
}

function startLevel() {
  document.getElementById('levelDisplay').textContent = `Seviye: ${level}`;
  document.getElementById('scoreDisplay').textContent = `Puan: ${score}`;
  const pairCount = level + 1;
  const selected = pickUniqueRandomImages(pairCount);
  const cards = shuffle([...selected, ...selected]);
  renderBoard(cards);
}

function pickUniqueRandomImages(count) {
  const available = Array.from({length: TOTAL_IMAGES}, (_, i) => `${IMAGE_PATH}${i+1}.jpg`);
  const picked = [];
  while (picked.length < count) {
    const img = available.splice(Math.floor(Math.random() * available.length), 1)[0];
    picked.push(img);
  }
  return picked;
}

function renderBoard(cards) {
  const board = document.getElementById('board');
  board.innerHTML = '';
  flippedCards = [];
  matchedPairs = 0;

  cards.forEach(src => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <div class="inner">
        <div class="front"><img src="${src}" alt=""></div>
        <div class="back"></div>
      </div>
    `;
    card.addEventListener('click', () => flipCard(card, src));
    board.appendChild(card);
  });
}

function flipCard(card, src) {
  if (card.classList.contains('flipped') || flippedCards.length === 2) return;
  flipSound.currentTime = 0; flipSound.play();
  card.classList.add('flipped');
  flippedCards.push({card, src});

  if (flippedCards.length === 2) {
    const [a, b] = flippedCards;
    if (a.src === b.src) {
      setTimeout(() => {
        matchSound.currentTime = 0; matchSound.play();
        a.card.classList.add('matched');
        b.card.classList.add('matched');
        score += 10;
        matchedPairs++;
        flippedCards = [];
        updateScore();
        if (matchedPairs === level + 1) {
          setTimeout(nextLevel, 1000);
        }
      }, 400);
    } else {
      score -= 2;
      updateScore();
      setTimeout(() => {
        a.card.classList.remove('flipped');
        b.card.classList.remove('flipped');
        flippedCards = [];
      }, 800);
    }
  }
}

function updateScore() {
  document.getElementById('scoreDisplay').textContent = `Puan: ${score}`;
}

function nextLevel() {
  level++;
  if (level > TOTAL_LEVELS) {
    alert(`üéâ Oyun bitti! Toplam puan: ${score}`);
    returnToMenu();
  } else {
    startLevel();
  }
}

function returnToMenu() {
  document.getElementById('menu').style.display = 'flex';
  document.getElementById('header').style.display = 'none';
  document.getElementById('board').style.display = 'none';
  document.getElementById('backToMenu').style.display = 'none';
}

function shuffle(array) {
  let arr = [...array];
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* ü´ß Baloncuk animasyonu */
const canvas = document.getElementById('bubbles');
const ctx = canvas.getContext('2d');
let bubbles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

for (let i = 0; i < 50; i++) {
  bubbles.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    r: Math.random() * 10 + 5,
    speed: Math.random() * 0.5 + 0.3,
    opacity: Math.random() * 0.5 + 0.3
  });
}

function drawBubbles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  bubbles.forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
    ctx.fillStyle = `rgba(255,255,255,${b.opacity})`;
    ctx.fill();
    b.y -= b.speed;
    if (b.y + b.r < 0) {
      b.y = canvas.height + b.r;
      b.x = Math.random() * canvas.width;
    }
  });
  requestAnimationFrame(drawBubbles);
}
drawBubbles();
</script>

</body>
</html>
