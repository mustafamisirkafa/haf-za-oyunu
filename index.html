<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ðŸ§  HafÄ±za EÅŸleÅŸtirme â€” Deluxe Edition</title>
<style>
  :root {
    --accent:#f77f00;
    --bg-a:#ff6f61; --bg-b:#6a5acd; --bg-c:#00b4d8; --bg-d:#ffd166;
  }
  html,body {
    margin:0; padding:0; height:100%;
    font-family: Arial, Helvetica, sans-serif; color:#fff;
    overflow:hidden;
    background:#111;
  }
  /* ðŸŒˆ Alt katman */
  body {
    background: linear-gradient(270deg,var(--bg-a),var(--bg-b),var(--bg-c),var(--bg-d));
    background-size: 800% 800%;
    animation: gradientFlow 24s ease infinite;
  }
  @keyframes gradientFlow {
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }
  /* ðŸ«§ Orta & Ã¼st katman */
  #bubbles, #shimmer {
    position: fixed;
    inset: 0;
    pointer-events: none;
  }
  #bubbles { z-index: 0; opacity: .5; }
  #shimmer { z-index: 1; opacity: .5; }
  /* MenÃ¼ */
  #menu {
    position:fixed; inset:0; display:flex; flex-direction:column; gap:14px;
    justify-content:center; align-items:center; text-align:center;
    background:rgba(0,0,0,.45); backdrop-filter: blur(8px); z-index:5;
  }
  .menu-btn {
    background:var(--accent); color:#fff; border:none; cursor:pointer;
    padding:12px 22px; border-radius:12px; font-size:18px; width:220px;
    box-shadow:0 6px 18px rgba(0,0,0,.25);
  }
  /* Ãœst bar */
  #header {
    position:sticky; top:0; z-index:4; display:none;
    background: rgba(0,0,0,.55); backdrop-filter: blur(6px);
    padding:10px; display:flex; gap:10px; align-items:center; justify-content:center;
  }
  .badge {
    display:inline-flex; align-items:center; gap:8px;
    background:#00000066; border:1px solid #ffffff29;
    padding:6px 10px; border-radius:999px; font-weight:700; font-size:14px;
  }
  .sound-btn {
    margin-left:8px; background:#ffffff22; border:1px solid #ffffff33; color:#fff;
    padding:6px 10px; border-radius:999px; cursor:pointer; font-size:14px;
  }
  /* Oyun alanÄ± */
  #board {
    display:none;
    grid-template-columns: repeat(3, 1fr);
    gap:10px; padding:12px; justify-items:center;
    height: calc(100dvh - 70px); overflow-y:auto;
    position: relative; z-index: 3;
  }
  .card {
    width:30vw; max-width:120px; aspect-ratio:1/1;
    border-radius:14px; overflow:hidden; cursor:pointer; perspective:900px;
    box-shadow: 0 6px 18px rgba(0,0,0,.25);
  }
  .inner {
    width:100%; height:100%; transform-style:preserve-3d;
    transition: transform .38s cubic-bezier(.2,.8,.2,1), filter .2s;
  }
  .flipped .inner { transform: rotateY(180deg); }
  .front,.back {
    position:absolute; inset:0; backface-visibility:hidden; border-radius:14px;
  }
  .front { transform: rotateY(180deg);}
  .front img { width:100%; height:100%; object-fit:cover; }
  .back {
    background-color:#d62828;
    background-image:
      repeating-linear-gradient(45deg, #fff 0px, #fff 3px, transparent 3px, transparent 10px),
      repeating-linear-gradient(-45deg, #fff 0px, #fff 3px, transparent 3px, transparent 10px);
    background-size:20px 20px; border:2px solid #fff;
  }
  .matched {
    pointer-events:none; border:3px solid #32d74b; filter:brightness(1.2);
    animation: zoomFlash .6s ease both;
  }
  @keyframes zoomFlash {
    0%{ transform: scale(1)}
    40%{ transform: scale(1.25); box-shadow:0 0 18px #32d74b}
    100%{ transform: scale(1); box-shadow:none}
  }
</style>
</head>
<body>

<canvas id="bubbles"></canvas>
<canvas id="shimmer"></canvas>

<section id="menu">
  <h1>ðŸ§  HafÄ±za EÅŸleÅŸtirme</h1>
  <button class="menu-btn" id="playBtn">ðŸŽ® Oyuna BaÅŸla</button>
</section>

<header id="header">
  <div class="badge">Seviye: <span id="levelDisplay">1</span></div>
  <div class="badge">Puan: <span id="scoreDisplay">0</span></div>
  <button class="sound-btn" id="soundToggle">ðŸ”Š Ses: AÃ§Ä±k</button>
</header>

<main id="board"></main>

<audio id="flipSound" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5d0c1c3b4b.mp3?filename=pop-94319.mp3"></audio>
<audio id="matchSound" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_d4d86a64f7.mp3?filename=soft-notification-102131.mp3"></audio>
<audio id="levelUpSound" preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2d8a6e8241.mp3?filename=success-1-6297.mp3"></audio>

<script>
// ðŸ«§ Baloncuk katmanÄ±
const bubbles = document.getElementById('bubbles');
const bctx = bubbles.getContext('2d');
function resizeBubbles() {
  bubbles.width = window.innerWidth;
  bubbles.height = window.innerHeight;
}
window.addEventListener('resize', resizeBubbles);
resizeBubbles();
const bubbleArr = Array.from({length:30}).map(()=>({
  x:Math.random()*bubbles.width,
  y:Math.random()*bubbles.height,
  r:Math.random()*40+20,
  s:Math.random()*0.3+0.1,
  a:Math.random()*Math.PI*2,
  c:`rgba(255,255,255,${Math.random()*0.07+0.03})`
}));
function animateBubbles(){
  bctx.clearRect(0,0,bubbles.width,bubbles.height);
  for(const p of bubbleArr){
    p.a+=0.0015; p.x+=Math.cos(p.a)*p.s; p.y+=Math.sin(p.a)*p.s;
    bctx.beginPath(); bctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    bctx.fillStyle=p.c; bctx.fill();
    if(p.x<-p.r||p.x>bubbles.width+p.r||p.y<-p.r||p.y>bubbles.height+p.r){
      p.x=Math.random()*bubbles.width; p.y=Math.random()*bubbles.height;
    }
  }
  requestAnimationFrame(animateBubbles);
}
animateBubbles();

// ðŸ§  HafÄ±za Oyunu
const IMAGE_PATH="./images/";
const TOTAL_IMAGES=41;
const TOTAL_LEVELS=10;
const MATCH_SCORE=10;
const FAIL_PENALTY=2;

let level=1, score=0, flipped=[], matchedPairs=0, mistakes=0, soundOn=true;
const board=document.getElementById('board');
const levelEl=document.getElementById('levelDisplay');
const scoreEl=document.getElementById('scoreDisplay');
const playBtn=document.getElementById('playBtn');
const soundToggle=document.getElementById('soundToggle');
const flipSound=document.getElementById('flipSound');
const matchSound=document.getElementById('matchSound');
const levelUpSound=document.getElementById('levelUpSound');

playBtn.onclick=()=>{
  document.getElementById('menu').style.display='none';
  document.getElementById('header').style.display='flex';
  board.style.display='grid';
  startLevel();
};
soundToggle.onclick=()=>setSound(!soundOn);
function setSound(on){
  soundOn=on;
  [flipSound,matchSound,levelUpSound].forEach(a=>a.muted=!on);
  soundToggle.textContent=on?"ðŸ”Š Ses: AÃ§Ä±k":"ðŸ”‡ Ses: KapalÄ±";
}

function startLevel(){
  levelEl.textContent=level;
  scoreEl.textContent=score;
  mistakes=0;flipped=[];matchedPairs=0;
  const pairCount=level+1;
  const selected=pickUniqueRandomImages(pairCount);
  const cards=shuffle([...selected,...selected]);
  renderBoard(cards);
}
function pickUniqueRandomImages(count){
  const pool=Array.from({length:TOTAL_IMAGES},(_,i)=>`${IMAGE_PATH}${i+1}.jpg`);
  const out=[];
  while(out.length<count){
    out.push(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
  }
  return out;
}
function renderBoard(cards){
  board.innerHTML='';
  cards.forEach(src=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`<div class="inner"><div class="front"><img src="${src}"></div><div class="back"></div></div>`;
    card.addEventListener('click',()=>flipCard(card,src));
    board.appendChild(card);
  });
}
function flipCard(card,src){
  if(card.classList.contains('flipped')||flipped.length===2)return;
  if(soundOn){flipSound.currentTime=0;flipSound.play().catch(()=>{});}
  card.classList.add('flipped');flipped.push({card,src});
  if(flipped.length===2){
    const[a,b]=flipped;
    if(a.src===b.src){
      setTimeout(()=>{
        if(soundOn){matchSound.currentTime=0;matchSound.play().catch(()=>{});}
        a.card.classList.add('matched');b.card.classList.add('matched');
        flipped=[];matchedPairs++;score+=MATCH_SCORE;scoreEl.textContent=score;
        if(matchedPairs===level+1){setTimeout(()=>levelComplete(),600);}
      },280);
    }else{
      mistakes++;score=Math.max(0,score-FAIL_PENALTY);scoreEl.textContent=score;
      setTimeout(()=>{a.card.classList.remove('flipped');b.card.classList.remove('flipped');flipped=[];},650);
    }
  }
}
function levelComplete(){
  if(soundOn){levelUpSound.currentTime=0;levelUpSound.play().catch(()=>{});}
  level++;
  if(level>TOTAL_LEVELS){
    alert(`ðŸŽ‰ Oyun bitti!\nToplam puan: ${score}`);
    location.reload();
  }else{
    startLevel();
  }
}
function shuffle(arr){
  let a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
</script>
