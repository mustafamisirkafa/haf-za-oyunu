<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ§  HafÄ±za Oyunu â€” Efektli</title>
<style>
  html,body {
    margin:0; padding:0;
    height:100%;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #ff7b00, #ff0099, #6a5acd, #00b4d8);
    background-size: 400% 400%;
    animation: bgflow 20s ease infinite;
    overflow-x:hidden;
  }
  @keyframes bgflow {
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }

  h1 {
    text-align:center;
    color:#fff;
    margin:15px 0;
    text-shadow: 0 0 10px #000;
  }

  #board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    justify-items: center;
    padding: 12px;
    max-width: 420px;
    margin: 0 auto;
    box-sizing: border-box;
  }

  .card {
    width: 30vw;
    max-width: 110px;
    aspect-ratio: 1/1;
    perspective: 800px;
    cursor: pointer;
    position: relative;
  }

  .inner {
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform .45s cubic-bezier(.2,.8,.2,1), box-shadow .3s;
    border-radius: 14px;
    box-shadow: 0 4px 10px rgba(0,0,0,.3);
  }

  .card:hover .inner {
    transform: scale(1.05);
  }

  .flipped .inner {
    transform: rotateY(180deg) scale(1.05);
    box-shadow: 0 0 16px 4px #fff5;
  }

  .front, .back {
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    border-radius: 14px;
    overflow: hidden;
  }

  .front {
    transform: rotateY(180deg);
  }

  .front img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .back {
    background-color: #d62828;
    background-image:
      repeating-linear-gradient(45deg, #fff 0px, #fff 3px, transparent 3px, transparent 10px),
      repeating-linear-gradient(-45deg, #fff 0px, #fff 3px, transparent 3px, transparent 10px);
    background-size: 20px 20px;
    border: 2px solid #fff;
  }

  .matched .inner {
    animation: matchedPulse 0.7s ease both;
    box-shadow: 0 0 16px 6px #32d74b;
  }

  @keyframes matchedPulse {
    0% { transform: scale(1) rotateY(180deg); }
    40% { transform: scale(1.2) rotateY(180deg); }
    100% { transform: scale(1) rotateY(180deg); }
  }

  canvas#particles {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 10;
  }
</style>
</head>
<body>

<h1>ðŸ§  HafÄ±za Oyunu</h1>
<canvas id="particles"></canvas>
<div id="board"></div>

<script>
// === Ayarlar ===
const TOTAL_IMAGES = 12; // hÄ±zlÄ± deneme iÃ§in az tuttum, istersen 41 yaparÄ±z
const IMAGE_PATH = "./images/"; // kendi klasÃ¶rÃ¼ne gÃ¶re ayarla
const TOTAL_LEVELS = 5;

// === DeÄŸiÅŸkenler ===
let level = 1;
let flipped = [];
let matchedPairs = 0;

// === BaÅŸlat ===
startLevel();

function startLevel() {
  matchedPairs = 0;
  flipped = [];
  const pairCount = level + 1;
  const selected = pickUniqueRandomImages(pairCount);
  const cards = shuffle([...selected, ...selected]);
  renderBoard(cards);
}

function pickUniqueRandomImages(count){
  const pool = Array.from({length:TOTAL_IMAGES},(_,i)=>`${IMAGE_PATH}${i+1}.jpg`);
  const out=[];
  while(out.length<count){
    const idx = Math.floor(Math.random()*pool.length);
    out.push(pool.splice(idx,1)[0]);
  }
  return out;
}

function renderBoard(cards){
  const board=document.getElementById('board');
  board.innerHTML='';
  cards.forEach(src=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <div class="inner">
        <div class="front"><img src="${src}"></div>
        <div class="back"></div>
      </div>
    `;
    card.addEventListener('click',()=>flipCard(card,src));
    board.appendChild(card);
  });
}

function flipCard(card, src){
  if(card.classList.contains('flipped')||flipped.length===2)return;
  card.classList.add('flipped');
  flipped.push({card,src});
  if(flipped.length===2){
    const[a,b]=flipped;
    if(a.src===b.src){
      setTimeout(()=>{
        a.card.classList.add('matched');
        b.card.classList.add('matched');
        spawnParticles(a.card);
        spawnParticles(b.card);
        flipped=[];
        matchedPairs++;
        if(matchedPairs===level+1){
          setTimeout(()=>{level++; startLevel();},800);
        }
      },250);
    }else{
      setTimeout(()=>{
        a.card.classList.remove('flipped');
        b.card.classList.remove('flipped');
        flipped=[];
      },700);
    }
  }
}

// === Shuffle ===
function shuffle(arr){
  let a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

// === PartikÃ¼l Efekti ===
const canvas=document.getElementById('particles');
const ctx=canvas.getContext('2d');
let particles=[];
function resize(){canvas.width=window.innerWidth; canvas.height=window.innerHeight;}
window.addEventListener('resize',resize); resize();

function spawnParticles(el){
  const rect=el.getBoundingClientRect();
  const cx=rect.left+rect.width/2;
  const cy=rect.top+rect.height/2;
  for(let i=0;i<15;i++){
    particles.push({
      x:cx,y:cy,
      vx:(Math.random()-0.5)*4,
      vy:(Math.random()-0.5)*4-2,
      r:Math.random()*3+2,
      life:60,
      color:`hsl(${Math.random()*360},100%,60%)`
    });
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach((p,i)=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.05;
    p.life--;
    ctx.globalAlpha=p.life/60;
    ctx.fillStyle=p.color;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  });
  particles=particles.filter(p=>p.life>0);
  requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
